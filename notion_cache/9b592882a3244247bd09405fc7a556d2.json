{
  "ID": "9b592882-a324-4247-bd09-405fc7a556d2",
  "Page": {
    "alive": true,
    "content": [
      "435daa67-a784-42d5-9b92-888c5df774b6",
      "bac1c65b-6614-434e-a046-532e185b7db8",
      "3c47268f-944d-4c19-a58a-0ef5a90515c0",
      "ce917edb-c02e-4e7e-a059-6e5524e52c8b",
      "177d4d7d-4baa-40b5-9974-caec466bafb3",
      "17daafdd-d651-46fc-b56b-ff64857fe193",
      "53e6de13-9d6d-46c2-8342-28c7dda2ca6b",
      "8ec3e910-9f18-43a7-9b24-26b0714395c0",
      "0a8316c3-8d85-4f59-a2d1-611f972f0300",
      "070333ff-98bd-4818-8498-1808ce1b7082",
      "e86988da-a269-4c6c-8da4-4e704d9117fb",
      "fdbd2b12-2bf2-4bac-923b-286f185d4b8d",
      "86287e82-48f4-42a2-8039-d6f194ec2ed0",
      "38b08fa1-10f2-4a6f-9b3a-8fa579cc128b",
      "3c7daee6-a5cf-4b22-b8b9-13d636f324a7",
      "2ac1d620-c688-4ea4-b02a-08e5c1942b58",
      "d05d00fa-813c-4572-99e1-c4a4b2fa2b05",
      "907f05fe-1d2a-4d7a-8e75-741b539df085",
      "da478122-0a51-4729-ba92-2099b842c00f",
      "0e3212fe-e2dc-4546-a48e-f7b7ada55fcf",
      "aadbd65f-30fc-43b5-8b65-548571329b50",
      "27f1410b-7d6e-4fe9-a7d2-8c0db51bf509",
      "1bd4e81b-f532-45ea-a32c-1e89b9c24584",
      "c88fc227-563f-4e28-9779-dd778709dc57",
      "46cfb1ef-5f34-4abf-9f96-4433474efb81",
      "e3776def-5a91-4186-87ba-129b54849659",
      "23734325-0b50-44af-ae00-33d84bd36b68",
      "9d91465f-1d71-4026-86be-52b8837bdd68",
      "7c1520d6-42e8-4393-87ed-f1d40522cfe3",
      "75db8ce5-2f18-4678-822b-58756583d7e6",
      "dff6c880-d7a0-4d7c-a896-5983966d9f1f",
      "106ac49c-d77a-4248-a584-364937ce8de1",
      "bb4c5e03-c4ac-4a61-b68f-58a668046203",
      "10b6dd9b-deff-413d-ba14-c9f72dee38ad",
      "7fbdbb45-8965-4e9e-8bca-98bcafaebd27",
      "54c59578-3cd7-4009-9b56-7c9565f12a9a",
      "f31da754-20f8-453f-bfd3-ce690d7153fd",
      "f5f0e491-8666-438b-8e39-6c9fcea79a1e",
      "8ad6c064-0e0d-4d59-bfda-ff08f390505d",
      "e453bf9e-cd10-4976-b9b0-9dd6e7021bf8",
      "a11ba7f8-9cb9-490e-b380-f45e4ebe466e",
      "38fa9dc6-9088-43cc-91ee-29412242c5dc",
      "340068da-c064-4f19-b8e8-ccba2bcf8e75",
      "0a3ae148-90a8-4421-9e95-9ec8962d1c65",
      "d2258e42-328c-4b99-a22c-b51c690f9bfe",
      "9ecb6751-e8ab-4ed9-be59-b07e2ebe050a",
      "916009cc-5175-474a-bf52-c9954253206c",
      "433ec005-3528-48b6-9bd4-198327c1e498",
      "196a134a-b60f-40e0-85a0-d50debf94f24",
      "6d8a667c-ad1a-4aab-bf5f-e367f82ddab1",
      "63c86da0-584d-4972-8cf1-c6a6ab1ff5c8",
      "4d0286be-ad4a-4944-aba1-2942d838c989",
      "29f99681-9e73-4f96-8865-ddc917a1c515",
      "67387344-bf90-41a8-9743-0c34bc57fcbf",
      "ac16832d-4cb6-4c3c-8b96-adfdfff1d3b0",
      "e50fe697-6221-4030-951d-e0697bfc6d7f",
      "c948db15-6b62-4c78-8f74-eb905e8edd61"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1531204099818,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "9b592882-a324-4247-bd09-405fc7a556d2",
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1531736728118,
    "parent_id": "300db9dc-27c8-4958-a08b-8d0c37f4cfe5",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Blueprint for deploying web apps on CoreOS"
        ]
      ]
    },
    "type": "page",
    "version": 15,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "435daa67-a784-42d5-9b92-888c5df774b6",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383413733,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Id: 5"
            ]
          ]
        },
        "type": "text",
        "version": 3,
        "inline_content": [
          {
            "Text": "Id: 5"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "bac1c65b-6614-434e-a046-532e185b7db8",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Date: 2017-02-11T19:18:21-08:00"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Date: 2017-02-11T19:18:21-08:00"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "3c47268f-944d-4c19-a58a-0ef5a90515c0",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Tags: devops, go"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Tags: devops, go"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "ce917edb-c02e-4e7e-a059-6e5524e52c8b",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "HeaderImage: gfx/headers/header-00.jpg"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "HeaderImage: gfx/headers/header-00.jpg"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "177d4d7d-4baa-40b5-9974-caec466bafb3",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383411436,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "type": "text",
        "version": 3
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "17daafdd-d651-46fc-b56b-ff64857fe193",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "I used to deploy my web apps on Ubuntu running on Digital Ocean but recently I switched to using "
            ],
            [
              "CoreOS",
              [
                [
                  "a",
                  "https://coreos.com/"
                ]
              ]
            ],
            [
              " instead of Ubuntu."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "I used to deploy my web apps on Ubuntu running on Digital Ocean but recently I switched to using "
          },
          {
            "Text": "CoreOS",
            "Link": "https://coreos.com/"
          },
          {
            "Text": " instead of Ubuntu."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "53e6de13-9d6d-46c2-8342-28c7dda2ca6b",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "For a while I didn’t understand CoreOS; a linux distro without package manager? How do I install more software on this thing?"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "For a while I didn’t understand CoreOS; a linux distro without package manager? How do I install more software on this thing?"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "8ec3e910-9f18-43a7-9b24-26b0714395c0",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Now I am a convert. CoreOS is not a Linux distro for end users. It’s a distro for deploying applications packaged as docker containers."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Now I am a convert. CoreOS is not a Linux distro for end users. It’s a distro for deploying applications packaged as docker containers."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "0a8316c3-8d85-4f59-a2d1-611f972f0300",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The benefit of using CoreOS is less configuration needed compared to e.g. Ubuntu."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The benefit of using CoreOS is less configuration needed compared to e.g. Ubuntu."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "070333ff-98bd-4818-8498-1808ce1b7082",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "I used to deploy multiple apps per server but for operational simplicity I moved to using one server per app. At $5 per server (my apps are written in Go, so they run comfortably on the smallest servers) it’s a reasonable cost."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "I used to deploy multiple apps per server but for operational simplicity I moved to using one server per app. At $5 per server (my apps are written in Go, so they run comfortably on the smallest servers) it’s a reasonable cost."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "e86988da-a269-4c6c-8da4-4e704d9117fb",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Here’s my playbook for deploying an app on CoreOS. This example is how I deploy my "
            ],
            [
              "blog",
              [
                [
                  "a",
                  "https://github.com/kjk/blog"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Here’s my playbook for deploying an app on CoreOS. This example is how I deploy my "
          },
          {
            "Text": "blog",
            "Link": "https://github.com/kjk/blog"
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "fdbd2b12-2bf2-4bac-923b-286f185d4b8d",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "1. Create a unique ssh key for the machine",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "1. Create a unique ssh key for the machine",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "86287e82-48f4-42a2-8039-d6f194ec2ed0",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "For security it’s good to have a unique ssh key for each machine:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "For security it’s good to have a unique ssh key for each machine:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "38b08fa1-10f2-4a6f-9b3a-8fa579cc128b",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "ssh-keygen -t rsa -b 4096 -C \"a comment\"",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " : creates a new ssh key, save it as "
            ],
            [
              "id_rsa",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "ssh-keygen -t rsa -b 4096 -C \"a comment\"",
            "AttrFlags": 2
          },
          {
            "Text": " : creates a new ssh key, save it as "
          },
          {
            "Text": "id_rsa",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "3c7daee6-a5cf-4b22-b8b9-13d636f324a7",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "content of "
            ],
            [
              "id_rsa.pub",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " is what you give DigitalOcean as ssh key when creating a server"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "content of "
          },
          {
            "Text": "id_rsa.pub",
            "AttrFlags": 2
          },
          {
            "Text": " is what you give DigitalOcean as ssh key when creating a server"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "2ac1d620-c688-4ea4-b02a-08e5c1942b58",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "After server is created, verify you can login: "
            ],
            [
              "ssh -i ./id_rsa core@\u003cip_address\u003e",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "After server is created, verify you can login: "
          },
          {
            "Text": "ssh -i ./id_rsa core@\u003cip_address\u003e",
            "AttrFlags": 2
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "d05d00fa-813c-4572-99e1-c4a4b2fa2b05",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "2. Initial server setup",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "2. Initial server setup",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "907f05fe-1d2a-4d7a-8e75-741b539df085",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "To make the scripts more re-usable, create "
            ],
            [
              "ipaddr.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "To make the scripts more re-usable, create "
          },
          {
            "Text": "ipaddr.sh",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "da478122-0a51-4729-ba92-2099b842c00f",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383424154,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "# e.g. IPADDR=137.63.26.193\nIPADDR=\u003cip address of the server\u003e\n# git likes to loose non-standard permissions. This is always called from\n# scripts so a good place to ensure right permissions on id_rsa\nchmod 0600 id_rsa"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "# e.g. IPADDR=137.63.26.193\nIPADDR=\u003cip address of the server\u003e\n# git likes to loose non-standard permissions. This is always called from\n# scripts so a good place to ensure right permissions on id_rsa\nchmod 0600 id_rsa",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099818,
        "id": "0e3212fe-e2dc-4546-a48e-f7b7ada55fcf",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099818,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "For convenience I also write "
            ],
            [
              "login.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "For convenience I also write "
          },
          {
            "Text": "login.sh",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "aadbd65f-30fc-43b5-8b65-548571329b50",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383428615,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\n. ./ipaddr.sh\nssh -i ./id_rsa core@${IPADDR}"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\n. ./ipaddr.sh\nssh -i ./id_rsa core@${IPADDR}",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "27f1410b-7d6e-4fe9-a7d2-8c0db51bf509",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Usually a kernel benefits from one or more tweaks. Some tweaks don’t persist and have to be applied at startup. We’ll use "
            ],
            [
              "systemd",
              [
                [
                  "c"
                ],
                [
                  "a",
                  "https://www.freedesktop.org/wiki/Software/systemd/"
                ]
              ]
            ],
            [
              " to run startup script and adjust kernel parameters. We need several files. files on the server:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Usually a kernel benefits from one or more tweaks. Some tweaks don’t persist and have to be applied at startup. We’ll use "
          },
          {
            "Text": "systemd",
            "AttrFlags": 2,
            "Link": "https://www.freedesktop.org/wiki/Software/systemd/"
          },
          {
            "Text": " to run startup script and adjust kernel parameters. We need several files. files on the server:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "1bd4e81b-f532-45ea-a32c-1e89b9c24584",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "startup.conf",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " ("
            ],
            [
              "/etc/sysctl.d/startup.conf",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " on the server):"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "startup.conf",
            "AttrFlags": 2
          },
          {
            "Text": " ("
          },
          {
            "Text": "/etc/sysctl.d/startup.conf",
            "AttrFlags": 2
          },
          {
            "Text": " on the server):"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "c88fc227-563f-4e28-9779-dd778709dc57",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "# http://security.stackexchange.com/questions/43205/nf-conntrack-table-full-dropping-packet\n# https://coreos.com/os/docs/latest/other-settings.html\nnet.netfilter.nf_conntrack_max=131072\n# in seconds, default value was 600 == 5 mins\nnet.netfilter.nf_conntrack_generic_timeout = 60\n# in seconds, default value was 432000 i.e. 5 days\nnet.netfilter.nf_conntrack_tcp_timeout_established = 54000\n# was 46992\nfs.file-max = 131072"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "# http://security.stackexchange.com/questions/43205/nf-conntrack-table-full-dropping-packet\n# https://coreos.com/os/docs/latest/other-settings.html\nnet.netfilter.nf_conntrack_max=131072\n# in seconds, default value was 600 == 5 mins\nnet.netfilter.nf_conntrack_generic_timeout = 60\n# in seconds, default value was 432000 i.e. 5 days\nnet.netfilter.nf_conntrack_tcp_timeout_established = 54000\n# was 46992\nfs.file-max = 131072",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "46cfb1ef-5f34-4abf-9f96-4433474efb81",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "startup.conf",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " contains the settings. Default values for connection tracking are so low that it’s easy for a malicious person to DoS your server just by opening a small number of connections to your http server."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "startup.conf",
            "AttrFlags": 2
          },
          {
            "Text": " contains the settings. Default values for connection tracking are so low that it’s easy for a malicious person to DoS your server just by opening a small number of connections to your http server."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "e3776def-5a91-4186-87ba-129b54849659",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "This is for the smallest server with 512 MB of RAM. Increase for larger servers."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "This is for the smallest server with 512 MB of RAM. Increase for larger servers."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "23734325-0b50-44af-ae00-33d84bd36b68",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "startup_script.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " ("
            ],
            [
              "/etc/systemd/system/startup_script.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " on the server):"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "startup_script.sh",
            "AttrFlags": 2
          },
          {
            "Text": " ("
          },
          {
            "Text": "/etc/systemd/system/startup_script.sh",
            "AttrFlags": 2
          },
          {
            "Text": " on the server):"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "9d91465f-1d71-4026-86be-52b8837bdd68",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383447288,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\n\n# reload values from /etc/sysctl.d/startup.conf\nsysctl --system\n# make hashsize match net.netfilter.nf_conntrack_max (should be nf_conntrack_max / 4)\n# https://security.stackexchange.com/questions/43205/nf-conntrack-table-full-dropping-packet\necho 32768 \u003e /sys/module/nf_conntrack/parameters/hashsize"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\n\n# reload values from /etc/sysctl.d/startup.conf\nsysctl --system\n# make hashsize match net.netfilter.nf_conntrack_max (should be nf_conntrack_max / 4)\n# https://security.stackexchange.com/questions/43205/nf-conntrack-table-full-dropping-packet\necho 32768 \u003e /sys/module/nf_conntrack/parameters/hashsize",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "7c1520d6-42e8-4393-87ed-f1d40522cfe3",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "This script makes the changes. Now we need to make sure it gets called at startup."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "This script makes the changes. Now we need to make sure it gets called at startup."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "75db8ce5-2f18-4678-822b-58756583d7e6",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "startup.service",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " ("
            ],
            [
              "/etc/systemd/system/startup.service",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " on the server):"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "startup.service",
            "AttrFlags": 2
          },
          {
            "Text": " ("
          },
          {
            "Text": "/etc/systemd/system/startup.service",
            "AttrFlags": 2
          },
          {
            "Text": " on the server):"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "dff6c880-d7a0-4d7c-a896-5983966d9f1f",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "# http://unix.stackexchange.com/questions/47695/how-to-write-startup-script-for-systemd\n[Unit]\nDescription=things to do after each reboot\n# just to be safe, run it after docker started\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nType=oneshot\n# per https://www.digitalocean.com/community/tutorials/how-to-create-and-run-a-service-on-a-coreos-cluster\nEnvironmentFile=/etc/environment\n# '=-' means it can fail\nExecStart=-/etc/systemd/system/startup_script.sh\n\n[Install]\nWantedBy=multi-user.target"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "# http://unix.stackexchange.com/questions/47695/how-to-write-startup-script-for-systemd\n[Unit]\nDescription=things to do after each reboot\n# just to be safe, run it after docker started\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nType=oneshot\n# per https://www.digitalocean.com/community/tutorials/how-to-create-and-run-a-service-on-a-coreos-cluster\nEnvironmentFile=/etc/environment\n# '=-' means it can fail\nExecStart=-/etc/systemd/system/startup_script.sh\n\n[Install]\nWantedBy=multi-user.target",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "106ac49c-d77a-4248-a584-364937ce8de1",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "I have "
            ],
            [
              "initial-server-setup.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " script to automate putting those files on the server and configure "
            ],
            [
              "systemd",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " to notice it."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "I have "
          },
          {
            "Text": "initial-server-setup.sh",
            "AttrFlags": 2
          },
          {
            "Text": " script to automate putting those files on the server and configure "
          },
          {
            "Text": "systemd",
            "AttrFlags": 2
          },
          {
            "Text": " to notice it."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "bb4c5e03-c4ac-4a61-b68f-58a668046203",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383490638,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\nset -u -e -o pipefail\n\n. ./ipaddr.sh\n\nscp -i ./id_rsa ./startup.conf ./startup.service ./startup_script.sh core@${IPADDR}:/home/core/\n\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\nsudo cp startup.conf /etc/sysctl.d/startup.conf\nsudo chmod 0644 /etc/sysctl.d/startup.conf\nsudo cp startup.service /etc/systemd/system\nsudo cp startup_script.sh /etc/systemd/system\nsudo chmod 0750 /etc/systemd/system/startup_script.sh\nsudo systemctl daemon-reload\nsudo systemctl enable /etc/systemd/system/startup.service\n\nsudo bash -c \"echo 32768 \u003e /sys/module/nf_conntrack/parameters/hashsize\"\nsudo sysctl --system\nrm startup.conf startup.service startup_script.sh\nENDSSH"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\nset -u -e -o pipefail\n\n. ./ipaddr.sh\n\nscp -i ./id_rsa ./startup.conf ./startup.service ./startup_script.sh core@${IPADDR}:/home/core/\n\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\nsudo cp startup.conf /etc/sysctl.d/startup.conf\nsudo chmod 0644 /etc/sysctl.d/startup.conf\nsudo cp startup.service /etc/systemd/system\nsudo cp startup_script.sh /etc/systemd/system\nsudo chmod 0750 /etc/systemd/system/startup_script.sh\nsudo systemctl daemon-reload\nsudo systemctl enable /etc/systemd/system/startup.service\n\nsudo bash -c \"echo 32768 \u003e /sys/module/nf_conntrack/parameters/hashsize\"\nsudo sysctl --system\nrm startup.conf startup.service startup_script.sh\nENDSSH",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "10b6dd9b-deff-413d-ba14-c9f72dee38ad",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Run "
            ],
            [
              "initial-server-setup.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and test that the changes are applied:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Run "
          },
          {
            "Text": "initial-server-setup.sh",
            "AttrFlags": 2
          },
          {
            "Text": " and test that the changes are applied:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "7fbdbb45-8965-4e9e-8bca-98bcafaebd27",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "login to the server with "
            ],
            [
              "./login.sh",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "login to the server with "
          },
          {
            "Text": "./login.sh",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "54c59578-3cd7-4009-9b56-7c9565f12a9a",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "reboot with "
            ],
            [
              "sudo shutdown -r now",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "reboot with "
          },
          {
            "Text": "sudo shutdown -r now",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "f31da754-20f8-453f-bfd3-ce690d7153fd",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "login again"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "login again"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "f5f0e491-8666-438b-8e39-6c9fcea79a1e",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "sudo sysctl -a | grep nf_conntrack_max",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 1,
        "inline_content": [
          {
            "Text": "sudo sysctl -a | grep nf_conntrack_max",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "8ad6c064-0e0d-4d59-bfda-ff08f390505d",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "3. Use systemctld to automatically restart the app",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "3. Use systemctld to automatically restart the app",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "e453bf9e-cd10-4976-b9b0-9dd6e7021bf8",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "When the server reboots we want the app to start automatically."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "When the server reboots we want the app to start automatically."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "a11ba7f8-9cb9-490e-b380-f45e4ebe466e",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "We also want the app to automatically restart if it crashes."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "We also want the app to automatically restart if it crashes."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "38fa9dc6-9088-43cc-91ee-29412242c5dc",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "We’ll use "
            ],
            [
              "systemd",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " again as it comes with CoreOS."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "We’ll use "
          },
          {
            "Text": "systemd",
            "AttrFlags": 2
          },
          {
            "Text": " again as it comes with CoreOS."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "340068da-c064-4f19-b8e8-ccba2bcf8e75",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Create "
            ],
            [
              "blog.service",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " ("
            ],
            [
              "/etc/systemd/system/blog.service",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " on the server) file which instructs "
            ],
            [
              "systemd",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " how to run a docker container named "
            ],
            [
              "blog",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Create "
          },
          {
            "Text": "blog.service",
            "AttrFlags": 2
          },
          {
            "Text": " ("
          },
          {
            "Text": "/etc/systemd/system/blog.service",
            "AttrFlags": 2
          },
          {
            "Text": " on the server) file which instructs "
          },
          {
            "Text": "systemd",
            "AttrFlags": 2
          },
          {
            "Text": " how to run a docker container named "
          },
          {
            "Text": "blog",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "0a3ae148-90a8-4421-9e95-9ec8962d1c65",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Plain Text"
            ]
          ],
          "title": [
            [
              "[Unit]\nDescription=blog\n# this unit will only start after docker.service\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nTimeoutStartSec=0\n# per https://www.digitalocean.com/community/tutorials/how-to-create-and-run-a-service-on-a-coreos-cluster\nEnvironmentFile=/etc/environment\n# before starting make sure it doesn't exist\n# '=-' means it can fail\nExecStartPre=-/usr/bin/docker rm blog\nExecStart=/usr/bin/docker run --rm -p 80:80 -v /data-blog:/data --name blog blog:latest\nExecStop=/usr/bin/docker stop blog\n# restart if it crashes or is killed e.g. by oom\nRestart=on-failure\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target"
            ]
          ]
        },
        "type": "code",
        "version": 1,
        "code": "[Unit]\nDescription=blog\n# this unit will only start after docker.service\nAfter=docker.service\nRequires=docker.service\n\n[Service]\nTimeoutStartSec=0\n# per https://www.digitalocean.com/community/tutorials/how-to-create-and-run-a-service-on-a-coreos-cluster\nEnvironmentFile=/etc/environment\n# before starting make sure it doesn't exist\n# '=-' means it can fail\nExecStartPre=-/usr/bin/docker rm blog\nExecStart=/usr/bin/docker run --rm -p 80:80 -v /data-blog:/data --name blog blog:latest\nExecStop=/usr/bin/docker stop blog\n# restart if it crashes or is killed e.g. by oom\nRestart=on-failure\nRestartSec=5\n\n[Install]\nWantedBy=multi-user.target",
        "code_language": "Plain Text"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099819,
        "id": "d2258e42-328c-4b99-a22c-b51c690f9bfe",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099819,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "It’s a one-time operation but I still like to have it as a script named "
            ],
            [
              "install-service.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "It’s a one-time operation but I still like to have it as a script named "
          },
          {
            "Text": "install-service.sh",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "9ecb6751-e8ab-4ed9-be59-b07e2ebe050a",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383495398,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\nset -u -e -o pipefail\n\n. ./ipaddr.sh\n\nscp -i ./id_rsa ./blog.service core@${IPADDR}:/home/core/blog.service\n\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\ncd /home/core\nsudo cp blog.service /etc/systemd/system\nsudo systemctl enable /etc/systemd/system/blog.service\nrm blog.service\nENDSSH"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\nset -u -e -o pipefail\n\n. ./ipaddr.sh\n\nscp -i ./id_rsa ./blog.service core@${IPADDR}:/home/core/blog.service\n\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\ncd /home/core\nsudo cp blog.service /etc/systemd/system\nsudo systemctl enable /etc/systemd/system/blog.service\nrm blog.service\nENDSSH",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "916009cc-5175-474a-bf52-c9954253206c",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "You need to re-run it after updating "
            ],
            [
              "blog.service",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " file."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "You need to re-run it after updating "
          },
          {
            "Text": "blog.service",
            "AttrFlags": 2
          },
          {
            "Text": " file."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "433ec005-3528-48b6-9bd4-198327c1e498",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "4. Package the app as a Docker image and upload to the server",
              [
                [
                  "b"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "4. Package the app as a Docker image and upload to the server",
            "AttrFlags": 1
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "196a134a-b60f-40e0-85a0-d50debf94f24",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "A script to build the app, package as Docker image and upload latest version to the server."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "A script to build the app, package as Docker image and upload latest version to the server."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "6d8a667c-ad1a-4aab-bf5f-e367f82ddab1",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The most common advice for uploading/downloading docker images is to use docker registry. For simplicity I just use "
            ],
            [
              "docker save",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "/"
            ],
            [
              "docker load",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and "
            ],
            [
              "scp",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "The most common advice for uploading/downloading docker images is to use docker registry. For simplicity I just use "
          },
          {
            "Text": "docker save",
            "AttrFlags": 2
          },
          {
            "Text": "/"
          },
          {
            "Text": "docker load",
            "AttrFlags": 2
          },
          {
            "Text": " and "
          },
          {
            "Text": "scp",
            "AttrFlags": 2
          },
          {
            "Text": "."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "63c86da0-584d-4972-8cf1-c6a6ab1ff5c8",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Here’s a "
            ],
            [
              "build_and_upload.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " script:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Here’s a "
          },
          {
            "Text": "build_and_upload.sh",
            "AttrFlags": 2
          },
          {
            "Text": " script:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "4d0286be-ad4a-4944-aba1-2942d838c989",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383498636,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\n\n# build latest version of the app, upload to the server packaged as\n# blog:latest docker image\n\nset -u -e -o pipefail\n\n. ./ipaddr.sh\n\ndir=`pwd`\nblog_dir=${GOPATH}/src/github.com/kjk/blog\n\necho \"building\"\ncp config.json \"${blog_dir}\"\ncd \"${blog_dir}\"\nGOOS=linux GOARCH=amd64 go build -o blog_linux\ndocker build --no-cache --tag blog:latest .\nrm blog_linux\ncd \"${dir}\"\n\necho \"docker save\"\ndocker save blog:latest | bzip2 \u003e blog-latest.tar.bz2\nls -lah blog-latest.tar.bz2\n\necho \"uploading to the server\"\nscp -i ./id_rsa blog-latest.tar.bz2 core@${IPADDR}:/home/core/blog-latest.tar.bz2\n\necho \"extracting on the server\"\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\ncd /home/core\nbunzip2 --stdout blog-latest.tar.bz2 | docker load\nrm blog-latest.tar.bz2\nsudo systemctl restart blog\nENDSSH\n\nrm -rf blog-latest.tar.bz2"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\n\n# build latest version of the app, upload to the server packaged as\n# blog:latest docker image\n\nset -u -e -o pipefail\n\n. ./ipaddr.sh\n\ndir=`pwd`\nblog_dir=${GOPATH}/src/github.com/kjk/blog\n\necho \"building\"\ncp config.json \"${blog_dir}\"\ncd \"${blog_dir}\"\nGOOS=linux GOARCH=amd64 go build -o blog_linux\ndocker build --no-cache --tag blog:latest .\nrm blog_linux\ncd \"${dir}\"\n\necho \"docker save\"\ndocker save blog:latest | bzip2 \u003e blog-latest.tar.bz2\nls -lah blog-latest.tar.bz2\n\necho \"uploading to the server\"\nscp -i ./id_rsa blog-latest.tar.bz2 core@${IPADDR}:/home/core/blog-latest.tar.bz2\n\necho \"extracting on the server\"\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\ncd /home/core\nbunzip2 --stdout blog-latest.tar.bz2 | docker load\nrm blog-latest.tar.bz2\nsudo systemctl restart blog\nENDSSH\n\nrm -rf blog-latest.tar.bz2",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "29f99681-9e73-4f96-8865-ddc917a1c515",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "You can see a sample "
            ],
            [
              "Dockerfile",
              [
                [
                  "c"
                ],
                [
                  "a",
                  "https://github.com/kjk/blog/blob/master/Dockerfile"
                ]
              ]
            ],
            [
              " and a sample "
            ],
            [
              "docker_build.sh",
              [
                [
                  "c"
                ],
                [
                  "a",
                  "https://github.com/kjk/blog/blob/master/s/docker_build.sh"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "You can see a sample "
          },
          {
            "Text": "Dockerfile",
            "AttrFlags": 2,
            "Link": "https://github.com/kjk/blog/blob/master/Dockerfile"
          },
          {
            "Text": " and a sample "
          },
          {
            "Text": "docker_build.sh",
            "AttrFlags": 2,
            "Link": "https://github.com/kjk/blog/blob/master/s/docker_build.sh"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "67387344-bf90-41a8-9743-0c34bc57fcbf",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "After deploying the app for the first time you should restart the server ("
            ],
            [
              "shutdown -r",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ") to verify that the app will start up after reboot."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "After deploying the app for the first time you should restart the server ("
          },
          {
            "Text": "shutdown -r",
            "AttrFlags": 2
          },
          {
            "Text": ") to verify that the app will start up after reboot."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "ac16832d-4cb6-4c3c-8b96-adfdfff1d3b0",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531204099820,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "I also have a sceript "
            ],
            [
              "logs.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " that logs in to the server and shows logs for the docker service in follow mode (like "
            ],
            [
              "tail -f",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "):"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "I also have a sceript "
          },
          {
            "Text": "logs.sh",
            "AttrFlags": 2
          },
          {
            "Text": " that logs in to the server and shows logs for the docker service in follow mode (like "
          },
          {
            "Text": "tail -f",
            "AttrFlags": 2
          },
          {
            "Text": "):"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531204099820,
        "id": "e50fe697-6221-4030-951d-e0697bfc6d7f",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383503177,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Shell"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\n\n. ./ipaddr.sh\n\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\ncd /home/core\ndocker logs -f blog\nENDSSH"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\n\n. ./ipaddr.sh\n\nssh -i ./id_rsa core@${IPADDR} \u003c\u003c'ENDSSH'\ncd /home/core\ndocker logs -f blog\nENDSSH",
        "code_language": "Shell"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531383503973,
        "id": "c948db15-6b62-4c78-8f74-eb905e8edd61",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531383503973,
        "parent_id": "9b592882-a324-4247-bd09-405fc7a556d2",
        "parent_table": "block",
        "type": "text",
        "version": 4
      }
    ],
    "title": "Blueprint for deploying web apps on CoreOS",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 9
    }
  ],
  "Collections": null,
  "CollectionViews": null
}